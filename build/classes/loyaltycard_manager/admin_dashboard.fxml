<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx/20.0.1"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="controller.AdminDashboardController">

    <!-- ðŸŒˆ Sidebar -->
    <left>
        <VBox spacing="20" style="-fx-background-color: linear-gradient(to bottom, #2C3E50, #34495E);" prefWidth="220">
            <padding>
                <Insets top="40" right="20" bottom="40" left="20"/>
            </padding>

            <Label text="âš™ Admin Dashboard" style="-fx-text-fill: white; -fx-font-size: 22px; -fx-font-weight: bold;"/>

            <Button text="ðŸ  Home" prefWidth="180" onAction="#showDashboard"
                    style="-fx-background-color: #1ABC9C; -fx-text-fill: white; -fx-font-size: 16px;"/>
            <Button text="ðŸ“¥ Payment" prefWidth="180" onAction="#showPayment"
                    style="-fx-background-color: #dd425a; -fx-text-fill: white; -fx-font-size: 16px;"/>
            <Button text="ðŸ‘¥ Users" prefWidth="180" onAction="#showUsers"
                    style="-fx-background-color: #3498DB; -fx-text-fill: white; -fx-font-size: 16px;"/>
            <Button text="ðŸ’³ Cards" prefWidth="180" onAction="#showCards"
                    style="-fx-background-color: #9B59B6; -fx-text-fill: white; -fx-font-size: 16px;"/>
            <Button text="ðŸ“ Card Assign" prefWidth="180" onAction="#showCardAssign"
                    style="-fx-background-color: #2ECC71; -fx-text-fill: white; -fx-font-size: 16px;"/>
            <Button text="ðŸ“Š Transactions" prefWidth="180" onAction="#showTransactions"
                    style="-fx-background-color: #F39C12; -fx-text-fill: white; -fx-font-size: 16px;"/>
            <Button text="ðŸšª Logout" prefWidth="180" onAction="#logout"
                    style="-fx-background-color: #E74C3C; -fx-text-fill: white; -fx-font-size: 16px;"/>
        </VBox>
    </left>

    <!-- ðŸŒ Top Bar -->
    <top>
        <HBox spacing="20" style="-fx-background-color: #16A085;" prefHeight="60" alignment="CENTER_RIGHT">
            <padding><Insets top="10" right="25" bottom="10" left="25"/></padding>
            <Label text="Welcome to the Admin Panel" style="-fx-text-fill: white; -fx-font-size: 18px; -fx-font-weight: bold;"/>
        </HBox>
    </top>

    <!-- ðŸ’¡ Main Content Area -->
    <center>
        <StackPane fx:id="mainContent" style="-fx-background-color: #ECF0F1;">

            <!-- ðŸ“ˆ Dashboard Summary -->
            <VBox fx:id="dashboardSummary" spacing="25" alignment="TOP_CENTER">
                <padding><Insets top="40" right="50" bottom="40" left="50"/></padding>
                <Label text="ðŸ“ˆ Dashboard Summary" style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #2C3E50;"/>
                <Separator prefWidth="600"/>
                <HBox spacing="30" alignment="CENTER">
                    <VBox spacing="10" alignment="CENTER" style="-fx-background-color: #1ABC9C; -fx-background-radius: 12px;" prefWidth="180" prefHeight="100">
                        <Label text="ðŸ‘¥ Users" style="-fx-text-fill: white; -fx-font-size: 18px;"/>
                        <Label fx:id="userCountLabel" text="0" style="-fx-text-fill: white; -fx-font-size: 22px; -fx-font-weight: bold;"/>
                    </VBox>
                    <VBox spacing="10" alignment="CENTER" style="-fx-background-color: #3498DB; -fx-background-radius: 12px;" prefWidth="180" prefHeight="100">
                        <Label text="ðŸ’³ Active Cards" style="-fx-text-fill: white; -fx-font-size: 18px;"/>
                        <Label fx:id="activeCardsLabel" text="0" style="-fx-text-fill: white; -fx-font-size: 22px; -fx-font-weight: bold;"/>
                    </VBox>
                    <VBox spacing="10" alignment="CENTER" style="-fx-background-color: #E67E22; -fx-background-radius: 12px;" prefWidth="180" prefHeight="100">
                        <Label text="ðŸ“Š Today's Txns" style="-fx-text-fill: white; -fx-font-size: 18px;"/>
                        <Label fx:id="todaysTxnLabel" text="0" style="-fx-text-fill: white; -fx-font-size: 22px; -fx-font-weight: bold;"/>
                    </VBox>
                </HBox>
            </VBox>

            <!-- ðŸ‘¥ Users Table -->
            <VBox fx:id="usersView" spacing="10" alignment="TOP_CENTER" visible="false" managed="false">
                <Label text="ðŸ‘¥ Registered Users" style="-fx-font-size: 26px; -fx-font-weight: bold; -fx-text-fill: #2C3E50;"/>
                <TableView fx:id="usersTable" prefWidth="700" prefHeight="400">
                    <columns>
                        <TableColumn fx:id="colId" text="ID" prefWidth="50"/>
                        <TableColumn fx:id="colFullName" text="Full Name" prefWidth="150"/>
                        <TableColumn fx:id="colUsername" text="Username" prefWidth="150"/>
                        <TableColumn fx:id="colEmail" text="Email" prefWidth="180"/>
                        <TableColumn fx:id="colPhone" text="Phone" prefWidth="120"/>
                        <TableColumn fx:id="colCreatedAt" text="Created At" prefWidth="150"/>
                    </columns>
                </TableView>
                <Button text="Back to Dashboard" onAction="#showDashboard"
                        style="-fx-background-color: #3498DB; -fx-text-fill: white; -fx-font-size: 14px; -fx-background-radius: 8px;"/>
            </VBox>
            
            <!-- ðŸ“¥ Payment View -->
            <VBox fx:id="paymentView" spacing="15" alignment="TOP_CENTER" visible="false" managed="false">
                <padding><Insets top="40" left="50" right="50" bottom="40"/></padding>

                <Label text="ðŸ“¥ Process Payment" style="-fx-font-size: 26px; -fx-font-weight: bold; -fx-text-fill: #2C3E50;"/>

                <HBox spacing="10" alignment="CENTER_LEFT">
                    <Label text="Card Number:"/>
                    <TextField fx:id="cardNumberField" promptText="Enter card number" prefWidth="250"/>
                </HBox>

                <HBox spacing="10" alignment="CENTER_LEFT">
                    <Label text="Invoice Amount (à§³):"/>
                    <TextField fx:id="invoiceAmountField" promptText="Enter amount" prefWidth="250"/>
                </HBox>

                <Button text="Pay" onAction="#handlePayment"
                        style="-fx-background-color: #27AE60; -fx-text-fill: white; -fx-font-size: 15px;"/>

                <Label fx:id="paymentStatusLabel" text="" style="-fx-text-fill: #C0392B; -fx-font-size: 14px; -fx-font-weight: bold;"/>

                <Button text="Back to Dashboard" onAction="#showDashboard"
                        style="-fx-background-color: #dd425a; -fx-text-fill: white; -fx-font-size: 14px; -fx-background-radius: 8px;"/>
            </VBox>

            <!-- ðŸ’³ Cards Table -->
            <VBox fx:id="cardsView" spacing="10" alignment="TOP_CENTER" visible="false" managed="false">
                <Label text="ðŸ’³ Issued Cards" style="-fx-font-size: 26px; -fx-font-weight: bold; -fx-text-fill: #2C3E50;"/>
                <TableView fx:id="cardsTable" prefWidth="750" prefHeight="400">
                    <columns>
                        <TableColumn fx:id="colCardId" text="ID" prefWidth="50"/>
                        <TableColumn fx:id="colCardNumber" text="Card No" prefWidth="150"/>
                        <TableColumn fx:id="colCardType" text="Type" prefWidth="100"/>
                        <TableColumn fx:id="colBalance" text="Balance" prefWidth="100"/>
                        <TableColumn fx:id="colCardUser" text="User" prefWidth="120"/>
                        <TableColumn fx:id="colIssueDate" text="Issued At" prefWidth="150"/>
                    </columns>
                </TableView>
                <Button text="Back to Dashboard" onAction="#showDashboard"
                        style="-fx-background-color: #9B59B6; -fx-text-fill: white; -fx-font-size: 14px; -fx-background-radius: 8px;"/>
            </VBox>

            <!-- ðŸ“ Card Assign View -->
            <VBox fx:id="cardAssignView" spacing="15" alignment="TOP_CENTER" visible="false" managed="false">
                <padding><Insets top="40" left="50" right="50" bottom="40"/></padding>

                <Label text="ðŸ“ Assign Loyalty Card" style="-fx-font-size: 26px; -fx-font-weight: bold; -fx-text-fill: #2C3E50;"/>

                <!-- Updated: User ID Field Instead of ComboBox -->
                <HBox spacing="10">
                    <Label text="User ID:"/>
                    <TextField fx:id="userIdField" promptText="Enter user ID" prefWidth="200"/>
                </HBox>

                <HBox spacing="10">
                    <Label text="Card Type:"/>
                    <ComboBox fx:id="cardTypeComboBox" prefWidth="200"/>
                </HBox>

                <HBox spacing="10">
                    <Label text="Amount (à§³):"/>
                    <Label fx:id="priceLabel" text="-" style="-fx-font-weight: bold;"/>
                    <Label text="Discount (%):"/>
                    <Label fx:id="discountLabel" text="-" style="-fx-font-weight: bold;"/>
                </HBox>

                <Button text="Assign Card" onAction="#handleAssignCard"
                        style="-fx-background-color: #2ECC71; -fx-text-fill: white; -fx-font-size: 15px;"/>
                <Button text="Back to Dashboard" onAction="#showDashboard"
                        style="-fx-background-color: #F39C12; -fx-text-fill: white; -fx-font-size: 14px; -fx-background-radius: 8px;"/>
            </VBox>

            <!-- ðŸ“Š Transactions Table -->
            <VBox fx:id="transactionsView" spacing="10" alignment="TOP_CENTER" visible="false" managed="false">
                <Label text="ðŸ“Š All Transactions" style="-fx-font-size: 26px; -fx-font-weight: bold; -fx-text-fill: #2C3E50;"/>
                <TableView fx:id="transactionsTable" prefWidth="800" prefHeight="400">
                    <columns>
                        <TableColumn fx:id="colTxnId" text="ID" prefWidth="50"/>
                        <TableColumn fx:id="colCardNumberCard" text="Card No" prefWidth="120"/>
                        <TableColumn fx:id="colTxnDate" text="Date" prefWidth="140"/>
                        <TableColumn fx:id="colAmount" text="Amount" prefWidth="100"/>
                        <TableColumn fx:id="colDiscount" text="Discount" prefWidth="100"/>
                        <TableColumn fx:id="colFinalAmount" text="Final Amt" prefWidth="100"/>
                        <TableColumn fx:id="colBalanceAfter" text="Balance" prefWidth="100"/>
                        <TableColumn fx:id="colTxnType" text="Type" prefWidth="90"/>
                        <TableColumn fx:id="colRemarks" text="Remarks" prefWidth="150"/>
                    </columns>
                </TableView>
                <Button text="Back to Dashboard" onAction="#showDashboard"
                        style="-fx-background-color: #F39C12; -fx-text-fill: white; -fx-font-size: 14px; -fx-background-radius: 8px;"/>
            </VBox>
        </StackPane>
    </center>
</BorderPane>
